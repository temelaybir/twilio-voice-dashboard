# ============================================
# GÜVENLİK KURALLARI - .env ve hassas dosyaları koruma
# ============================================

# .env ve tüm gizli dosyaları koruma
<FilesMatch "^\.">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order allow,deny
        Deny from all
    </IfModule>
</FilesMatch>

# .env ve .env.* dosyalarını koruma
<FilesMatch "^\.env">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order allow,deny
        Deny from all
    </IfModule>
</FilesMatch>

# scripts/ klasöründeki PHP dosyalarını web'den engelle (sadece CLI)
<IfModule mod_rewrite.c>
    RewriteEngine On
    # scripts/ klasöründeki PHP dosyalarını engelle
    RewriteCond %{REQUEST_URI} ^/scripts/.*\.php$ [NC]
    RewriteRule ^.*$ - [F,L]
</IfModule>

# Hassas dosyaları koruma
<FilesMatch "(\.env|\.git|\.log|config\.json|package-lock\.json|composer\.lock)$">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order allow,deny
        Deny from all
    </IfModule>
</FilesMatch>

# Directory listing'i kapat
Options -Indexes

# PHP hata mesajlarını gizle (production güvenliği)
<IfModule mod_php.c>
    php_flag display_errors Off
    php_flag log_errors On
</IfModule>

# ============================================
# WORDPRESS KURALLARI
# ============================================

# BEGIN WordPress
# The directives (lines) between "BEGIN WordPress" and "END WordPress" are
# dynamically generated, and should only be modified via WordPress filters.
# Any changes to the directives between these markers will be overwritten.
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

Redirect 301 /york https://happysmileclinics.com/york-free-dental-consultation/
# END WordPress

# ============================================
# CORS KURALLARI
# ============================================

# REST API için CORS kuralları
<IfModule mod_headers.c>
    Header set Access-Control-Allow-Origin "*"
    Header set Access-Control-Allow-Methods "GET, POST, OPTIONS"
    Header set Access-Control-Allow-Headers "Content-Type, Authorization, X-API-Key"
</IfModule>